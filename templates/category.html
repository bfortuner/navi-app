{% extends "base.html" %}

{% block content %}

<div class="topicoverview">
  <h1>{{cat.name}}</h1>
  <div class="navLinks">
    <a id="greenButton" href="javascript:poptastic('/c/{{cat.name}}/addlink')">+ Add Link</a>
    <script type="text/javascript">
      var newwindow;
      function poptastic(url)
      {
      newwindow=window.open(url,'name','height=500,width=460,top=100,left=450');
      if (window.focus) {newwindow.focus()}
      }
    </script>
  </div>

  <p>{{cat.getDescription()}}</p>
</div>

<div id="subtopics">
        <h2>Essential Subtopics</h2>
        {% for subcat in cat.subcategories %}
	<div class="categories"><a href="/c/{{subcat}}">{{subcat}}</a></div>
	{% endfor %}
	<div class="categories"><a href="/c/{{category}}/add-category">+ Add Category</a></div>
</div>


<div id="links">
        <div id="highestrated">
          <form name="">
            <p><select name="example" size="1" onChange="go()">
                <option value="">Highest Rated</option>
                <option value="">Most Recent</option>
            </select></p>
          </form>
        </div>
        <h2>These Resources Will Get You Up To Speed</h2>
</div>

<div id="categoryList"> <!--Start of Category List-->
{% for link in linkList %}
        <div class="problem">
                <div class="probNum">{{loop.index}}.</div>

                <div class="probSnippet">
                        <div class="snippetTitle"><a href="{{link.getURL()}}">{{link.getTitle()}}</a></div>
			<div class="description">
			  <pre class="snippetDesc">{{link.getDesc()[:300]}}</pre>
			</div>
                        <!--<div class="submitted">Submitted by <a href="">Brendan Fortuner</a>, Student at University of Virginia</div>-->
                </div><!--End Snippet Section-->

                <div class="rating">
                        <div class="difficultyScore"><img class="iqscore" src={{ url_for('static', filename='images/iqscore.png') }} alt="quality score"/>{{link.getRating()}}</div>
                        <div class="votes">{{ link.getRatingVotes() }} votes</div>
			{% if user != None %}
                        <div class="rate">
			  <!--{{link.getLinkId()}}-->
			  <form name="{{link.getLinkId()}}" method="post"> Rate:
                            <!--<select accesskey="S" onchange="javascript:onClick = alert('Sorry! We are still working on that feature.')">-->
			      <select name="rate" id="difficulty" onchange="vote({{loop.index}})">
				{% if user.getUserDiff(link.getLinkId()) == 0 or user.getUserDiff(link.getLinkId()) == None %}
				<option value="0 {{link.getLinkId()}}" {% if user.getUserDiff(link.getLinkId()) == 0 %} selected {% endif %}>-</option>
				{% endif %}
				<option value="1 {{link.getLinkId()}}" {% if user.getUserDiff(link.getLinkId()) == 1 %} selected {% endif %}>1</option>
				<option value="2 {{link.getLinkId()}}" {% if user.getUserDiff(link.getLinkId()) == 2 %} selected {% endif %}>2</option>
				<option value="3 {{link.getLinkId()}}" {% if user.getUserDiff(link.getLinkId()) == 3 %} selected {% endif %}>3</option>
                            </select>
                          </form>
			</div><!--End Rate-->
			{% endif %}
                </div><!--End Rating-->


		<div class="clear"></div>
        </div><!-- End Problem -->

{% endfor %}
</div><!--End Category List -->


<script type="text/javascript">
function vote(link_id) {
//    document.write(typeof link_id)
    var new_id = link_id.toString();
//    document.write(typeof new_id)
    document.forms[link_id].submit();
} 
</script>


{% endblock %}
